<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
    <!-- CSS Imports -->
    <link rel="stylesheet" href="/css/style.css">
    <!--     import Fluent UI icons -->
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css">
   
</head>
<body>
    <main>
      <form>
        <label for="name">Name</label><br />
        <input
          id="name"
          name="name"
          type="text"
          placeholder="Your name"
          required
        />
        <br /><br />
        <label for="email">Email</label><br />
        <input
          id="email"
          name="email"
          type="text"
          placeholder="Your email"
          required
        />
        <br /><br />
        <label for="message">Message</label><br />
        <textarea
          id="message"
          name="message"
          placeholder="Enter your message here"
          rows="3"
          required
        >
        </textarea>
        <br /><br />
        <button name="submit" type="submit" id = "submit">Submit!</button>
      </form>
      
      <script>
      
        const contactform = document.getElementsByTagName("form")[0];
        
        contactform.onsubmit = function(event) {
          
          event.preventDefault();
          
          var name = document.getElementById("name").value;
          var message = document.getElementById("message").value;
          var email = document.getElementById("email").value;
          
          var data = { "name": name, "email": email, "message": message };
          
          fetch("/contact", {
            method: 'POST',
            body: JSON.stringify(data),
            headers: {'Content-Type': 'application/json'},
          })
            .then(res => JSON.stringify(res))
            .then(data => {
              console.log(data);
            
              if (data.status === "404") {
                document.body.innerHTML = ("Uh oh, something went wrong! Try again later?");
              } else {
                document.body.innerHTML = ("<meta http-equiv='refresh' content='5;url='/home'/>Your form has been successfully sent!");
              }
              
            })
        
        }
        
      </script>
        </main>
  </body>
</html>